<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Match - Preview de Imagem</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #000;
            color: white;
        }
        
        .test-container {
            max-width: 600px;
            margin: 0 auto;
            text-align: center;
        }
        
        .test-button {
            background: #ae00ff;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
            box-shadow: 0 0 12px #ae00ff;
        }
        
        .test-button:hover {
            background: #9900dd;
        }
        
        .status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            background: #1f1f1f;
            border: 1px solid #333;
        }
        
        .success {
            border-color: #00ff00;
            color: #00ff00;
        }
        
        .error {
            border-color: #ff0000;
            color: #ff0000;
        }
        
        .popup-match {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        /* Mock profile structure */
        .profile {
            display: none;
        }
        
        .profile.active {
            display: block;
        }
        
        .carousel-image {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .profile-info h2 {
            margin: 10px 0;
        }
        
        .profile-content p {
            color: #ccc;
        }
        
        .info {
            background: #ae00ff;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            margin: 2px;
            display: inline-block;
            font-size: 12px;
        }
    </style>

<!-- Meta Pixel Code -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src='https://connect.facebook.net/en_US/fbevents.js';
  s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script');

  fbq('init', '1453046616041191');
  fbq('track', 'PageView');
</script>
<noscript>
  <img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=1453046616041191&ev=PageView&noscript=1"/>
</noscript>
<!-- End Meta Pixel Code -->

</head>
<body>
    <div class="test-container">
        <h1>üß™ Teste de Match - Preview de Imagem</h1>
        <p>Este teste verifica se o popup de match exibe corretamente a imagem de perfil.</p>
        
        <div id="status" class="status">
            Aguardando teste...
        </div>
        
        <button class="test-button" onclick="testarMatch()">üöÄ Testar Popup de Match</button>
        <button class="test-button" onclick="fecharPopup()">‚ùå Fechar Popup</button>
        
        <!-- Mock profile structure -->
        <div class="profile active" style="display: none;">
            <div class="profile-info">
                <h2>Bruna, 25</h2>
            </div>
            <div class="profile-content">
                <p>Enigm√°tica, carinhosa e com um toque de mist√©rio. Vem me descobrir...</p>
            </div>
            <div class="profile-content">
                <span class="info">üçæ Champanhe</span>
                <span class="info">üéµ Blues</span>
            </div>
            <img class="carousel-image" src="wp-content/uploads/2025/04/logoCoroa.png" alt="Perfil">
        </div>
        
        <!-- Popup de match -->
        <div class="popup-match"></div>
        
        <h3>üìã Checklist do Teste:</h3>
        <ul style="text-align: left; max-width: 400px; margin: 0 auto;">
            <li>‚úÖ Popup deve abrir com o t√≠tulo "üíú Match!"</li>
            <li>‚úÖ Imagem de perfil deve aparecer (n√£o um c√≠rculo vazio)</li>
            <li>‚úÖ Nome "Bruna" deve aparecer no popup</li>
            <li>‚úÖ Biografia deve estar vis√≠vel</li>
            <li>‚úÖ Tags (Champanhe, Blues) devem aparecer</li>
        </ul>
    </div>
    
    <script>
        function updateStatus(message, isSuccess = true) {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = 'status ' + (isSuccess ? 'success' : 'error');
        }
        
        function testarMatch() {
            updateStatus('üîÑ Iniciando teste...');
            
            // Chamar a fun√ß√£o exibirPopupMatch diretamente
            try {
                exibirPopupMatch();
                
                // Verificar se o popup foi aberto
                const popup = document.querySelector('.popup-match');
                if (popup && popup.style.display === 'flex') {
                    // Verificar se a imagem est√° presente
                    const img = popup.querySelector('img');
                    if (img && img.src && !img.src.includes('inicial.html')) {
                        updateStatus('‚úÖ Teste PASSOU! Popup de match funcionando corretamente com imagem.', true);
                    } else {
                        updateStatus('‚ùå Teste FALHOU! Imagem n√£o carregou corretamente no popup.', false);
                    }
                } else {
                    updateStatus('‚ùå Teste FALHOU! Popup n√£o foi exibido.', false);
                }
            } catch (error) {
                updateStatus('‚ùå Erro no teste: ' + error.message, false);
            }
        }
        
        function fecharPopup() {
            const popup = document.querySelector('.popup-match');
            if (popup) {
                popup.style.display = 'none';
                updateStatus('Popup fechado.');
            }
        }
        
        function irParaChatComPerfil() {
            updateStatus('üéâ Bot√£o "Conversar agora" funcionando!');
            fecharPopup();
        }
        
        // Fun√ß√£o exibirPopupMatch corrigida
        function exibirPopupMatch() {
            const popup = document.querySelector('.popup-match');
            if (!popup) {
                console.log("‚ùå Popup n√£o encontrado!");
                return;
            }

            const perfilAtivo = document.querySelector('.profile.active');
            if (!perfilAtivo) {
                console.log("‚ùå Perfil ativo n√£o encontrado!");
                return;
            }

            const img = perfilAtivo.querySelector('.carousel-image');
            const imgSrc = img ? img.src : '';

            const nomeIdade = perfilAtivo.querySelector('.profile-info h2')?.innerText || 'Nome';
            const bio = perfilAtivo.querySelector('.profile-content p')?.innerText || '...';

            const interesses = perfilAtivo.querySelectorAll('.profile-content:last-of-type .info');
            let tags = '';
            interesses.forEach((tag) => {
                tags += `<span style="background:#ae00ff;padding:4px 10px;border-radius:14px;font-size:12px;margin:2px;">${tag.textContent}</span>`;
            });

            const conteudoPopup = `
                <div style="background:#121212;border:2px solid #ae00ff;padding:30px 25px;border-radius:24px;color:white;width:340px;max-width:90%;box-shadow:0 0 25px #ae00ff;text-align:center;font-family:'Poppins',sans-serif;">
                  <h2 style="font-size:24px;font-weight:600;margin-bottom:10px;color:#ae00ff;">üíú Match!</h2>
                  <p style="font-size:14px;color:#ccc;margin-bottom:20px;">Voc√™s se conectaram! Agora √© sua chance de iniciar uma conversa inesquec√≠vel.</p>
                  <div style="display:flex;justify-content:center;margin-bottom:20px;"><img decoding="async" src="${imgSrc}" style="width:90px;height:90px;border-radius:50%;border:3px solid #ae00ff;box-shadow:0 0 15px #ae00ff;"/></div>
                  <div style="background:#1f1f1f;padding:15px;border-radius:14px;margin-bottom:20px;text-align:left;border:1px solid #333;">
                    <h3 style="margin:0 0 6px 0;font-size:16px;">${nomeIdade}</h3>
                    <p style="font-size:13px;margin:0 0 10px;color:#bbb;">${bio}</p>
                    <div style="display:flex;gap:6px;flex-wrap:wrap;">${tags}</div>
                  </div>
                  <button type="button" onclick="irParaChatComPerfil()" style="background:#ae00ff;color:white;font-weight:bold;padding:12px 20px;border:none;border-radius:25px;font-size:14px;cursor:pointer;width:100%;box-shadow:0 0 12px #ae00ff;">üí¨ Conversar agora</button>
                </div>
            `;

            popup.innerHTML = conteudoPopup;
            popup.style.display = 'flex';
            console.log("‚úÖ Match exibido com sucesso");
        }
        
        // Auto-executar o teste ap√≥s 1 segundo
        setTimeout(() => {
            updateStatus('üöÄ Executando teste autom√°tico...');
            testarMatch();
        }, 1000);
    </script>
</body>
</html>
